<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>
        CSVLayer - Project points on the fly | Sample | ArcGIS API for JavaScript 4.17
    </title>

    <link rel="stylesheet" href="https://js.arcgis.com/4.17/esri/themes/dark-red/main.css" />

    <style>
        html,
        body,
        #viewDiv {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
            background-color: black;
        }
    </style>

    <script src="https://js.arcgis.com/4.17/"></script>

    <script>
        require([
            "esri/WebMap",
            "esri/layers/CSVLayer",
            "esri/views/MapView",
            "esri/widgets/Legend",
            "esri/widgets/Expand"
        ], function(WebMap, CSVLayer, MapView, Legend, Expand) {
            const url =
                // "https://arcgis.github.io/arcgis-samples-javascript/sample-data/hurricanes.csv";
                "https://cdn.jsdelivr.net/gh/ManWingloeng/arcgis_img_proj@main/result_name.csv";
            // "https://cdn.jsdelivr.net/gh/ManWingloeng/arcgis_img_proj@main/hurricanes_name.csv";

            const csvLayer = new CSVLayer({
                title: "Hurricanes",
                url: url,
                copyright: "NOAA",
                // popupTemplate: {
                //     title: "{Name}",
                //     content: [{
                //         type: "text",
                //         text: "Category {Category} storm with that occurred at {ISO_time}."
                //     }, {
                //         type: "fields",
                //         fieldInfos: [{
                //             fieldName: "wmo_pres",
                //             label: "Pressure"
                //         }, {
                //             fieldName: "wmo_wind",
                //             label: "Wind Speed (mph)"
                //         }]
                //     }],
                //     fieldInfos: [{
                //         fieldName: "ISO_time",
                //         format: {
                //             dateFormat: "short-date-short-time"
                //         }
                //     }]
                // },
                renderer: {
                    type: "unique-value",
                    field: "Category",
                    uniqueValueInfos: createUniqueValueInfos()
                }
            });

            const map = new WebMap({
                // contains a basemap with a South Pole Stereographic projection
                // the CSVLayer coordinates will re-project client-side
                // with the Projection Engine to match the view's Spatial Reference
                basemap: {
                    portalItem: {
                        id: "3113eacc129942b4abde490a51aeb33f"
                    }
                },
                layers: [csvLayer]
            });

            const view = new MapView({
                container: "viewDiv",
                map: map,
                highlightOptions: {
                    color: "#ff642e",
                    haloOpacity: 1,
                    fillOpacity: 0.25
                },
                popup: {
                    dockEnabled: true,
                    dockOptions: {
                        breakpoint: false
                    }
                }
            });

            const legendExpand = new Expand({
                view: view,
                content: new Legend({
                    view: view,
                    style: "card"
                })
            });
            view.ui.add(legendExpand, "top-left");

            function createUniqueValueInfos() {
                const fireflyImages = [
                    "0_4x4.png",
                    "1_4x4.png",
                    "2_4x4.png",
                    "3_4x4.png",
                    "4_4x4.png",
                    "5_4x4.png",
                    "6_4x4.png",
                    "7_4x4.png",
                    "8_4x4.png",
                    "9_4x4.png",
                    "10_4x4.png",
                    "11_4x4.png",
                    "12_4x4.png",
                    "13_4x4.png",
                    "14_4x4.png",
                    "15_4x4.png",
                    "16_4x4.png",
                    "17_4x4.png",
                    "18_4x4.png",
                    "19_4x4.png",
                    "20_4x4.png",
                    "21_4x4.png",
                    "22_4x4.png",
                    "23_4x4.png",
                    "24_4x4.png",
                    "25_4x4.png",
                    "26_4x4.png",
                    "27_4x4.png",
                    "28_4x4.png",
                    "29_4x4.png",
                    "30_4x4.png",
                    "31_4x4.png",
                    "32_4x4.png",
                    "33_4x4.png",
                    "34_4x4.png",
                    "35_4x4.png",
                    "36_4x4.png",
                    "37_4x4.png",
                    "38_4x4.png",
                    "39_4x4.png",
                    "40_4x4.png",
                    "41_4x4.png",
                    "42_4x4.png",
                    "43_4x4.png",
                    "44_4x4.png",
                    "45_4x4.png",
                    "46_4x4.png",
                    "47_4x4.png",
                    "48_4x4.png",
                    "49_4x4.png",
                    "50_4x4.png",
                    "51_4x4.png",
                    "52_4x4.png",
                    "53_4x4.png",
                    "54_4x4.png",
                    "55_4x4.png",
                    "56_4x4.png",
                    "57_4x4.png",
                    "58_4x4.png",
                    "59_4x4.png",
                    "60_4x4.png",
                    "61_4x4.png",
                    "62_4x4.png",
                    "63_4x4.png",
                    "64_4x4.png",
                    "65_4x4.png",
                    "66_4x4.png",
                    "67_4x4.png",
                    "68_4x4.png",
                    "69_4x4.png",
                    "70_4x4.png",
                    "71_4x4.png",
                    "72_4x4.png",
                    "73_4x4.png",
                    "74_4x4.png",
                    "75_4x4.png",
                    "76_4x4.png",
                    "77_4x4.png",
                    "78_4x4.png",
                    "79_4x4.png",
                    "80_4x4.png",
                    "81_4x4.png",
                    "82_4x4.png",
                    "83_4x4.png",
                    "84_4x4.png",
                    "85_4x4.png",
                    "86_4x4.png",
                    "87_4x4.png",
                    "88_4x4.png",
                    "89_4x4.png",
                    "90_4x4.png",
                    "91_4x4.png",
                    "92_4x4.png",
                    "93_4x4.png",
                    "94_4x4.png",
                    "95_4x4.png",
                    "96_4x4.png",
                    "97_4x4.png",
                    "98_4x4.png",
                    "99_4x4.png",
                    "100_4x4.png",
                    "101_4x4.png",
                    "102_4x4.png",
                    "103_4x4.png",
                    "104_4x4.png",
                    "105_4x4.png",
                    "106_4x4.png",
                    "107_4x4.png",
                    "108_4x4.png",
                    "109_4x4.png",
                    "110_4x4.png",
                    "111_4x4.png",
                    "112_4x4.png",
                    "113_4x4.png",
                    "114_4x4.png",
                    "115_4x4.png",
                    "116_4x4.png",
                    "117_4x4.png",
                    "118_4x4.png",
                    "119_4x4.png",
                    "120_4x4.png",
                    "121_4x4.png",
                    "122_4x4.png",
                    "123_4x4.png",
                    "124_4x4.png",
                    "125_4x4.png",
                    "126_4x4.png",
                    "127_4x4.png",
                    "128_4x4.png",
                    "129_4x4.png",
                    "130_4x4.png",
                    "131_4x4.png",
                    "132_4x4.png",
                    "133_4x4.png",
                    "134_4x4.png",
                    "135_4x4.png",
                    "136_4x4.png",
                    "137_4x4.png",
                    "138_4x4.png",
                    "139_4x4.png",
                    "140_4x4.png",
                    "141_4x4.png",
                    "142_4x4.png",
                    "143_4x4.png",
                    "144_4x4.png",
                    "145_4x4.png",
                    "146_4x4.png",
                    "147_4x4.png",
                    "148_4x4.png",
                    "149_4x4.png",
                    "150_4x4.png",
                    "151_4x4.png",
                    "152_4x4.png",
                    "153_4x4.png",
                    "154_4x4.png",
                    "155_4x4.png",
                    "156_4x4.png",
                    "157_4x4.png",
                    "158_4x4.png",
                    "159_4x4.png",
                    "160_4x4.png",
                    "161_4x4.png",
                    "162_4x4.png",
                    "163_4x4.png",
                    "164_4x4.png",
                    "165_4x4.png",
                    "166_4x4.png",
                    "167_4x4.png",
                    "168_4x4.png",
                    "169_4x4.png",
                    "170_4x4.png",
                    "171_4x4.png",
                    "172_4x4.png",
                    "173_4x4.png",
                    "174_4x4.png",
                    "175_4x4.png",
                    "176_4x4.png",
                    "177_4x4.png",
                    "178_4x4.png",
                    "179_4x4.png",
                    "180_4x4.png",
                    "181_4x4.png",
                    "182_4x4.png",
                    "183_4x4.png",
                    "184_4x4.png",
                    "185_4x4.png",
                    "186_4x4.png",
                    "187_4x4.png",
                    "188_4x4.png",
                    "189_4x4.png",
                    "190_4x4.png",
                    "191_4x4.png",
                    "192_4x4.png",
                    "193_4x4.png",
                    "194_4x4.png",
                    "195_4x4.png",
                    "196_4x4.png",
                    "197_4x4.png",
                    "198_4x4.png",
                    "199_4x4.png",
                    "200_4x4.png",
                    "201_4x4.png",
                    "202_4x4.png",
                    "203_4x4.png",
                    "204_4x4.png",
                    "205_4x4.png",
                    "206_4x4.png",
                    "207_4x4.png",
                    "208_4x4.png",
                    "209_4x4.png",
                    "210_4x4.png",
                    "211_4x4.png",
                    "212_4x4.png",
                    "213_4x4.png",
                    "214_4x4.png",
                    "215_4x4.png",
                    "216_4x4.png",
                    "217_4x4.png",
                    "218_4x4.png",
                    "219_4x4.png",
                    "220_4x4.png",
                    "221_4x4.png",
                    "222_4x4.png",
                    "223_4x4.png",
                    "224_4x4.png",
                    "225_4x4.png",
                    "226_4x4.png",
                    "227_4x4.png",
                    "228_4x4.png",
                    "229_4x4.png",
                    "230_4x4.png",
                    "231_4x4.png",
                    "232_4x4.png",
                    "233_4x4.png",
                    "234_4x4.png",
                    "235_4x4.png",
                    "236_4x4.png",
                    "237_4x4.png",
                    "238_4x4.png",
                    "239_4x4.png",
                    "240_4x4.png",
                    "241_4x4.png",
                    "242_4x4.png",
                    "243_4x4.png",
                    "244_4x4.png",
                    "245_4x4.png",
                    "246_4x4.png",
                    "247_4x4.png",
                    "248_4x4.png",
                    "249_4x4.png",
                    "250_4x4.png",
                    "251_4x4.png",
                    "252_4x4.png",
                    "253_4x4.png",
                    "254_4x4.png"
                ];

                const baseUrl =
                    "https://cdn.jsdelivr.net/gh/ManWingloeng/arcgis_img_proj@main/colors_png/";

                return fireflyImages.map(function(url, i) {
                    return {
                        value: i + 1, // Category number
                        symbol: {
                            type: "picture-marker",
                            url: baseUrl + url
                        }
                    };
                });
            }
        });
    </script>
</head>

<body>
    <div id="viewDiv"></div>
</body>

</html>